let jsonDocument = [
    {
      "type": "draw2d.shape.basic.Rectangle",
      "id": "d278094b-8d1a-af71-f828-50129a034676",
      "x": 124,
      "y": 114,
      "width": 50,
      "height": 50,
      "alpha": 1,
      "angle": 0,
      "userData": {},
      "cssClass": "draw2d_shape_basic_Rectangle",
      "ports": [
        {
          "type": "draw2d.OutputPort",
          "id": "p1",
          "width": 10,
          "height": 10,
          "alpha": 1,
          "angle": 0,
          "userData": {},
          "cssClass": "draw2d_OutputPort",
          "bgColor": "#4F6870",
          "color": "#1B1B1B",
          "stroke": 1,
          "dasharray": null,
          "maxFanOut": 9007199254740991,
          "name": "output1",
          "port": "draw2d.OutputPort",
          "locator": "draw2d.layout.locator.OutputPortLocator"
        }
      ],
      "bgColor": "#A0A0A0",
      "color": "#1B1B1B",
      "stroke": 1,
      "radius": 0,
      "dasharray": null
    },
    {
      "type": "draw2d.shape.basic.Rectangle",
      "id": "d278094b-8d1a-af71-f828-50129a034677",
      "x": 124,
      "y": 220,
      "width": 50,
      "height": 50,
      "alpha": 1,
      "angle": 0,
      "userData": {},
      "cssClass": "draw2d_shape_basic_Rectangle",
      "ports": [
        {
          "type": "draw2d.OutputPort",
          "id": "p2",
          "width": 10,
          "height": 10,
          "alpha": 1,
          "angle": 0,
          "userData": {},
          "cssClass": "draw2d_OutputPort",
          "bgColor": "#4F6870",
          "color": "#1B1B1B",
          "stroke": 1,
          "dasharray": null,
          "maxFanOut": 9007199254740991,
          "name": "output2",
          "port": "draw2d.OutputPort",
          "locator": "draw2d.layout.locator.OutputPortLocator"
        }
      ],
      "bgColor": "#A0A0A0",
      "color": "#1B1B1B",
      "stroke": 1,
      "radius": 0,
      "dasharray": null
    },
    {
      "type": "draw2d.shape.basic.Rectangle",
      "id": "d278094b-8d1a-af71-f828-50129a034678",
      "x": 220,
      "y": 180,
      "width": 50,
      "height": 50,
      "alpha": 1,
      "angle": 0,
      "userData": {},
      "cssClass": "draw2d_shape_basic_Rectangle",
      "ports": [
        {
          "type": "draw2d.OutputPort",
          "id": "p3",
          "width": 10,
          "height": 10,
          "alpha": 1,
          "angle": 0,
          "userData": {},
          "cssClass": "draw2d_OutputPort",
          "bgColor": "#4F6870",
          "color": "#1B1B1B",
          "stroke": 2,
          "dasharray": null,
          "maxFanOut": 9007199254740991,
          "name": "output3",
          "port": "draw2d.OutputPort",
          "locator": "draw2d.layout.locator.OutputPortLocator"
        },
        {
          "type": "draw2d.InputPort",
          "id": "pI1",
          "width": 10,
          "height": 10,
          "alpha": 1,
          "angle": 0,
          "userData": {},
          "cssClass": "draw2d_InputPort",
          "bgColor": "#4F6870",
          "color": "#1B1B1B",
          "stroke": 1,
          "dasharray": null,
          "maxFanOut": 9007199254740991,
          "name": "input1",
          "port": "draw2d.InputPort",
          "locator": "draw2d.layout.locator.InputPortLocator"
        },
        {
          "type": "draw2d.InputPort",
          "id": "pI2",
          "width": 10,
          "height": 10,
          "alpha": 1,
          "angle": 0,
          "userData": {},
          "cssClass": "draw2d_InputPort",
          "bgColor": "#4F6870",
          "color": "#1B1B1B",
          "stroke": 1,
          "dasharray": null,
          "maxFanOut": 9007199254740991,
          "name": "input2",
          "port": "draw2d.InputPort",
          "locator": "draw2d.layout.locator.InputPortLocator"
        }
      ],
      "bgColor": "#A0A0A0",
      "color": "#1B1B1B",
      "stroke": 1,
      "radius": 0,
      "dasharray": null
    },
    {
      "type": "draw2d.shape.basic.Rectangle",
      "id": "d278094b-8d1a-af71-f828-50129a034679",
      "x": 320,
      "y": 180,
      "width": 50,
      "height": 50,
      "alpha": 1,
      "angle": 0,
      "userData": {},
      "cssClass": "draw2d_shape_basic_Rectangle",
      "ports": [
        {
          "type": "draw2d.InputPort",
          "id": "pI3",
          "width": 10,
          "height": 10,
          "alpha": 1,
          "angle": 0,
          "userData": {},
          "cssClass": "draw2d_InputPort",
          "bgColor": "#4F6870",
          "color": "#1B1B1B",
          "stroke": 1,
          "dasharray": null,
          "maxFanOut": 9007199254740991,
          "name": "input3",
          "port": "draw2d.InputPort",
          "locator": "draw2d.layout.locator.InputPortLocator"
        }
      ],
      "bgColor": "#A0A0A0",
      "color": "#1B1B1B",
      "stroke": 1,
      "radius": 0,
      "dasharray": null
    },
    {
      "type": "draw2d.Connection",
      "id": "60166325-cc58-14b1-cb79-76e77e2af5e3",
      "alpha": 1,
      "angle": 0,
      "userData": {},
      "cssClass": "draw2d_Connection",
      "stroke": 3,
      "color": "#129CE4",
      "outlineStroke": 1,
      "outlineColor": "#00A8F0",
      "policy": "draw2d.policy.line.LineSelectionFeedbackPolicy",
      "vertex": [
        {
          "x": 174,
          "y": 245
        },
        {
          "x": 197,
          "y": 245
        },
        {
          "x": 197,
          "y": 213.33333333333334
        },
        {
          "x": 220,
          "y": 213.33333333333334
        }
      ],
      "router": "draw2d.layout.connection.ManhattanBridgedConnectionRouter",
      "radius": 5,
      "source": {
        "node": "d278094b-8d1a-af71-f828-50129a034677",
        "port": "output2"
      },
      "target": {
        "node": "d278094b-8d1a-af71-f828-50129a034678",
        "port": "input2"
      }
    },
    {
      "type": "draw2d.Connection",
      "id": "8e695337-5e36-28f4-1d28-8d063b211834",
      "alpha": 1,
      "angle": 0,
      "userData": {},
      "cssClass": "draw2d_Connection",
      "stroke": 3,
      "color": "#129CE4",
      "outlineStroke": 1,
      "outlineColor": "#00A8F0",
      "policy": "draw2d.policy.line.LineSelectionFeedbackPolicy",
      "vertex": [
        {
          "x": 174,
          "y": 139
        },
        {
          "x": 197,
          "y": 139
        },
        {
          "x": 197,
          "y": 196.66666666666666
        },
        {
          "x": 220,
          "y": 196.66666666666666
        }
      ],
      "router": "draw2d.layout.connection.ManhattanBridgedConnectionRouter",
      "radius": 5,
      "source": {
        "node": "d278094b-8d1a-af71-f828-50129a034676",
        "port": "output1"
      },
      "target": {
        "node": "d278094b-8d1a-af71-f828-50129a034678",
        "port": "input1"
      }
    },
    {
      "type": "draw2d.Connection",
      "id": "87bc859d-0f9d-624f-b096-8b2bb22d736d",
      "alpha": 1,
      "angle": 0,
      "userData": {},
      "cssClass": "draw2d_Connection",
      "stroke": 3,
      "color": "#129CE4",
      "outlineStroke": 1,
      "outlineColor": "#00A8F0",
      "policy": "draw2d.policy.line.LineSelectionFeedbackPolicy",
      "vertex": [
        {
          "x": 270,
          "y": 205
        },
        {
          "x": 320,
          "y": 205
        }
      ],
      "router": "draw2d.layout.connection.ManhattanBridgedConnectionRouter",
      "radius": 5,
      "source": {
        "node": "d278094b-8d1a-af71-f828-50129a034678",
        "port": "output3"
      },
      "target": {
        "node": "d278094b-8d1a-af71-f828-50129a034679",
        "port": "input3"
      }
    },
    //-----------------------------PIPELINE 2--------------------------------------------------------------------------------
    {
        "type": "draw2d.shape.basic.Rectangle",
        "id": "d278094b-8d1a-af71-f828-50129a034680",
        "x": 520,
        "y": 114,
        "width": 50,
        "height": 50,
        "alpha": 1,
        "angle": 0,
        "userData": {},
        "cssClass": "draw2d_shape_basic_Rectangle",
        "ports": [
          {
            "type": "draw2d.OutputPort",
            "id": "p4",
            "width": 10,
            "height": 10,
            "alpha": 1,
            "angle": 0,
            "userData": {},
            "cssClass": "draw2d_OutputPort",
            "bgColor": "#4F6870",
            "color": "#1B1B1B",
            "stroke": 1,
            "dasharray": null,
            "maxFanOut": 9007199254740991,
            "name": "output4",
            "port": "draw2d.OutputPort",
            "locator": "draw2d.layout.locator.OutputPortLocator"
          }
        ],
        "bgColor": "#A0A0A0",
        "color": "#1B1B1B",
        "stroke": 1,
        "radius": 0,
        "dasharray": null
    },
    {
        "type": "draw2d.shape.basic.Rectangle",
        "id": "d278094b-8d1a-af71-f828-50129a034681",
        "x": 520,
        "y": 220,
        "width": 50,
        "height": 50,
        "alpha": 1,
        "angle": 0,
        "userData": {},
        "cssClass": "draw2d_shape_basic_Rectangle",
        "ports": [
          {
            "type": "draw2d.OutputPort",
            "id": "p5",
            "width": 10,
            "height": 10,
            "alpha": 1,
            "angle": 0,
            "userData": {},
            "cssClass": "draw2d_OutputPort",
            "bgColor": "#4F6870",
            "color": "#1B1B1B",
            "stroke": 1,
            "dasharray": null,
            "maxFanOut": 9007199254740991,
            "name": "output5",
            "port": "draw2d.OutputPort",
            "locator": "draw2d.layout.locator.OutputPortLocator"
          }
        ],
        "bgColor": "#A0A0A0",
        "color": "#1B1B1B",
        "stroke": 1,
        "radius": 0,
        "dasharray": null
    },
    {
        "type": "draw2d.shape.basic.Rectangle",
        "id": "d278094b-8d1a-af71-f828-50129a034682",
        "x": 520,
        "y": 326,
        "width": 50,
        "height": 50,
        "alpha": 1,
        "angle": 0,
        "userData": {},
        "cssClass": "draw2d_shape_basic_Rectangle",
        "ports": [
          {
            "type": "draw2d.OutputPort",
            "id": "p6",
            "width": 10,
            "height": 10,
            "alpha": 1,
            "angle": 0,
            "userData": {},
            "cssClass": "draw2d_OutputPort",
            "bgColor": "#4F6870",
            "color": "#1B1B1B",
            "stroke": 1,
            "dasharray": null,
            "maxFanOut": 9007199254740991,
            "name": "output6",
            "port": "draw2d.OutputPort",
            "locator": "draw2d.layout.locator.OutputPortLocator"
          }
        ],
        "bgColor": "#A0A0A0",
        "color": "#1B1B1B",
        "stroke": 1,
        "radius": 0,
        "dasharray": null
    },
    {
        "type": "draw2d.shape.basic.Rectangle",
        "id": "d278094b-8d1a-af71-f828-50129a034683",
        "x": 660,
        "y": 240,
        "width": 50,
        "height": 50,
        "alpha": 1,
        "angle": 0,
        "userData": {},
        "cssClass": "draw2d_shape_basic_Rectangle",
        "ports": [
          {
            "type": "draw2d.OutputPort",
            "id": "p7",
            "width": 10,
            "height": 10,
            "alpha": 1,
            "angle": 0,
            "userData": {},
            "cssClass": "draw2d_OutputPort",
            "bgColor": "#4F6870",
            "color": "#1B1B1B",
            "stroke": 2,
            "dasharray": null,
            "maxFanOut": 9007199254740991,
            "name": "output7",
            "port": "draw2d.OutputPort",
            "locator": "draw2d.layout.locator.OutputPortLocator"
          },
          {
            "type": "draw2d.InputPort",
            "id": "pI4",
            "width": 10,
            "height": 10,
            "alpha": 1,
            "angle": 0,
            "userData": {},
            "cssClass": "draw2d_InputPort",
            "bgColor": "#4F6870",
            "color": "#1B1B1B",
            "stroke": 1,
            "dasharray": null,
            "maxFanOut": 9007199254740991,
            "name": "input4",
            "port": "draw2d.InputPort",
            "locator": "draw2d.layout.locator.InputPortLocator"
          }
        ],
        "bgColor": "#A0A0A0",
        "color": "#1B1B1B",
        "stroke": 1,
        "radius": 0,
        "dasharray": null
      },
      {
        "type": "draw2d.shape.basic.Rectangle",
        "id": "d278094b-8d1a-af71-f828-50129a034684",
        "x": 780,
        "y": 240,
        "width": 50,
        "height": 50,
        "alpha": 1,
        "angle": 0,
        "userData": {},
        "cssClass": "draw2d_shape_basic_Rectangle",
        "ports": [
          {
            "type": "draw2d.InputPort",
            "id": "pI5",
            "width": 10,
            "height": 10,
            "alpha": 1,
            "angle": 0,
            "userData": {},
            "cssClass": "draw2d_InputPort",
            "bgColor": "#4F6870",
            "color": "#1B1B1B",
            "stroke": 1,
            "dasharray": null,
            "maxFanOut": 9007199254740991,
            "name": "input5",
            "port": "draw2d.InputPort",
            "locator": "draw2d.layout.locator.InputPortLocator"
          }
        ],
        "bgColor": "#A0A0A0",
        "color": "#1B1B1B",
        "stroke": 1,
        "radius": 0,
        "dasharray": null
      },
      {
        "type": "draw2d.Connection",
        "id": "6ee904f4-5d3e-27cd-dff5-ebcf0c8c7681",
        "alpha": 1,
        "angle": 0,
        "userData": {},
        "cssClass": "draw2d_Connection",
        "stroke": 3,
        "color": "#129CE4",
        "outlineStroke": 1,
        "outlineColor": "#00A8F0",
        "policy": "draw2d.policy.line.LineSelectionFeedbackPolicy",
        "vertex": [
          {
            "x": 570,
            "y": 351
          },
          {
            "x": 615,
            "y": 351
          },
          {
            "x": 615,
            "y": 265
          },
          {
            "x": 660,
            "y": 265
          }
        ],
        "router": "draw2d.layout.connection.ManhattanBridgedConnectionRouter",
        "radius": 5,
        "source": {
          "node": "d278094b-8d1a-af71-f828-50129a034682",
          "port": "output6"
        },
        "target": {
          "node": "d278094b-8d1a-af71-f828-50129a034683",
          "port": "input4"
        }
      },
      {
        "type": "draw2d.Connection",
        "id": "f9def745-e1c4-463e-0204-4ab1a8f12871",
        "alpha": 1,
        "angle": 0,
        "userData": {},
        "cssClass": "draw2d_Connection",
        "stroke": 3,
        "color": "#129CE4",
        "outlineStroke": 1,
        "outlineColor": "#00A8F0",
        "policy": "draw2d.policy.line.LineSelectionFeedbackPolicy",
        "vertex": [
          {
            "x": 570,
            "y": 245
          },
          {
            "x": 615,
            "y": 245
          },
          {
            "x": 615,
            "y": 265
          },
          {
            "x": 660,
            "y": 265
          }
        ],
        "router": "draw2d.layout.connection.ManhattanBridgedConnectionRouter",
        "radius": 5,
        "source": {
          "node": "d278094b-8d1a-af71-f828-50129a034681",
          "port": "output5"
        },
        "target": {
          "node": "d278094b-8d1a-af71-f828-50129a034683",
          "port": "input4"
        }
      },
      {
        "type": "draw2d.Connection",
        "id": "8889f779-7d18-fad7-baad-d7069313b233",
        "alpha": 1,
        "angle": 0,
        "userData": {},
        "cssClass": "draw2d_Connection",
        "stroke": 3,
        "color": "#129CE4",
        "outlineStroke": 1,
        "outlineColor": "#00A8F0",
        "policy": "draw2d.policy.line.LineSelectionFeedbackPolicy",
        "vertex": [
          {
            "x": 570,
            "y": 139
          },
          {
            "x": 615,
            "y": 139
          },
          {
            "x": 615,
            "y": 265
          },
          {
            "x": 660,
            "y": 265
          }
        ],
        "router": "draw2d.layout.connection.ManhattanBridgedConnectionRouter",
        "radius": 5,
        "source": {
          "node": "d278094b-8d1a-af71-f828-50129a034680",
          "port": "output4"
        },
        "target": {
          "node": "d278094b-8d1a-af71-f828-50129a034683",
          "port": "input4"
        }
      },
      {
        "type": "draw2d.Connection",
        "id": "87bc859d-0f9d-624f-b096-8b2bb22d736d",
        "alpha": 1,
        "angle": 0,
        "userData": {},
        "cssClass": "draw2d_Connection",
        "stroke": 3,
        "color": "#129CE4",
        "outlineStroke": 1,
        "outlineColor": "#00A8F0",
        "policy": "draw2d.policy.line.LineSelectionFeedbackPolicy",
        "vertex": [
          {
            "x": 270,
            "y": 205
          },
          {
            "x": 320,
            "y": 205
          }
        ],
        "router": "draw2d.layout.connection.ManhattanBridgedConnectionRouter",
        "radius": 5,
        "source": {
          "node": "d278094b-8d1a-af71-f828-50129a034678",
          "port": "output3"
        },
        "target": {
          "node": "d278094b-8d1a-af71-f828-50129a034679",
          "port": "input3"
        }
      },
      {
        "type": "draw2d.Connection",
        "id": "60166325-cc58-14b1-cb79-76e77e2af5e3",
        "alpha": 1,
        "angle": 0,
        "userData": {},
        "cssClass": "draw2d_Connection",
        "stroke": 3,
        "color": "#129CE4",
        "outlineStroke": 1,
        "outlineColor": "#00A8F0",
        "policy": "draw2d.policy.line.LineSelectionFeedbackPolicy",
        "vertex": [
          {
            "x": 174,
            "y": 245
          },
          {
            "x": 197,
            "y": 245
          },
          {
            "x": 197,
            "y": 213.33333333333334
          },
          {
            "x": 220,
            "y": 213.33333333333334
          }
        ],
        "router": "draw2d.layout.connection.ManhattanBridgedConnectionRouter",
        "radius": 5,
        "source": {
          "node": "d278094b-8d1a-af71-f828-50129a034677",
          "port": "output2"
        },
        "target": {
          "node": "d278094b-8d1a-af71-f828-50129a034678",
          "port": "input2"
        }
      },
      {
        "type": "draw2d.Connection",
        "id": "8e695337-5e36-28f4-1d28-8d063b211834",
        "alpha": 1,
        "angle": 0,
        "userData": {},
        "cssClass": "draw2d_Connection",
        "stroke": 3,
        "color": "#129CE4",
        "outlineStroke": 1,
        "outlineColor": "#00A8F0",
        "policy": "draw2d.policy.line.LineSelectionFeedbackPolicy",
        "vertex": [
          {
            "x": 174,
            "y": 139
          },
          {
            "x": 197,
            "y": 139
          },
          {
            "x": 197,
            "y": 196.66666666666666
          },
          {
            "x": 220,
            "y": 196.66666666666666
          }
        ],
        "router": "draw2d.layout.connection.ManhattanBridgedConnectionRouter",
        "radius": 5,
        "source": {
          "node": "d278094b-8d1a-af71-f828-50129a034676",
          "port": "output1"
        },
        "target": {
          "node": "d278094b-8d1a-af71-f828-50129a034678",
          "port": "input1"
        }
      },
      {
        "type": "draw2d.Connection",
        "id": "b44f59c5-2e4b-ce33-35ed-caa40f430622",
        "alpha": 1,
        "angle": 0,
        "userData": {},
        "cssClass": "draw2d_Connection",
        "stroke": 3,
        "color": "#129CE4",
        "outlineStroke": 1,
        "outlineColor": "#00A8F0",
        "policy": "draw2d.policy.line.LineSelectionFeedbackPolicy",
        "vertex": [
          {
            "x": 710,
            "y": 265
          },
          {
            "x": 780,
            "y": 265
          }
        ],
        "router": "draw2d.layout.connection.ManhattanBridgedConnectionRouter",
        "radius": 5,
        "source": {
          "node": "d278094b-8d1a-af71-f828-50129a034683",
          "port": "output7"
        },
        "target": {
          "node": "d278094b-8d1a-af71-f828-50129a034684",
          "port": "input5"
        }
      }
  ];

document.addEventListener("DOMContentLoaded",function () {

	  let canvas = new draw2d.Canvas("gfx_holder");

      canvas.installEditPolicy(  new draw2d.policy.connection.DragConnectionCreatePolicy({
         createConnection: function(){
            let c = new draw2d.Connection();
            c.setOutlineColor("#00A8F0");
            c.setOutlineStroke(1);
            c.setRadius(5);
            c.setStroke(3);
            c.setRouter(new draw2d.layout.connection.ManhattanBridgedConnectionRouter());
            return c;
         }
      }));

      let reader = new draw2d.io.json.Reader();
	  reader.unmarshal(canvas, jsonDocument);

      displayJSON(canvas);

      canvas.getCommandStack().addEventListener(function(e){
	      if(e.isPostChangeEvent()){
	          displayJSON(canvas);
	      }
	  });
});

function displayJSON(canvas){
    let writer = new draw2d.io.json.Writer();
    writer.marshal(canvas,function(json){
        $("#json").text(JSON.stringify(json, null, 2));
    });
}
